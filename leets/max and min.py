class Stack:
    def __init__(self):
        self.stack = []
        self.tos = -1

    def push(self, x):
        self.tos += 1
        self.stack.append(x)

    def pop(self):
        if self.tos == -1:
            return False

        self.tos -= 1
        self.stack.pop()
        return True
 
    def top(self):
        if self.tos == -1:
            return

        return self.stack[self.tos]

    def is_empty(self):
        return self.tos == -1


class Solution:
    # @param A : list of integers
    # @return an integer
    def solve(self, A):
        s1 = Stack()
        s2 = Stack()
        nsl = []
        ngl = []
        N = len(A)
        mod = 10 ** 9 + 7

        for ind in range(N):
            while not s1.is_empty() and A[s1.top()] >= A[ind]:
                s1.pop()

            if s1.is_empty():
                nsl.append(-1)
            else:
                nsl.append(s1.top())

            s1.push(ind)
            while not s2.is_empty() and A[s2.top()] <= A[ind]:
                s2.pop()

            if s2.is_empty():
                ngl.append(-1)
            else:
                ngl.append(s2.top())

            s2.push(ind)

        s1 = Stack()
        s2 = Stack()
        nsr = []
        ngr = []
        for ind in range(N-1, -1, -1):
            while not s1.is_empty() and A[s1.top()] >= A[ind]:
                s1.pop()

            if s1.is_empty():
                nsr.insert(0, N)
            else:
                nsr.insert(0, s1.top())

            s1.push(ind)

            while not s2.is_empty() and A[s2.top()] <= A[ind]:
                s2.pop()

            if s2.is_empty():
                ngr.insert(0, N)
            else:
                ngr.insert(0, s2.top())

            s2.push(ind)

        ans = 0
        for ind in range(N):
            maxs += (A[ind] * ((ind - ngl[ind]) * (ngr[ind] - ind)) % mod) % mod
            mins += (A[ind] * ((ind - nsl[ind]) * (nsr[ind] - ind)) % mod) % mod
            ans += (maxs - mins)

        return ans % mod


s = Solution()
A = [49695, 88703, 39041, 34876, 73994, 17360, 36655, 71399, 65316, 57692, 38803, 47998, 36536, 73307, 52777, 4912, 60981, 9211, 64968, 986146, 27506, 31098, 86294, 878562, 997396, 73667, 2092, 17389, 28824, 923014, 95436, 28919, 83519, 82575, 28043, 90647, 5892, 971355, 51832, 986400, 62439, 2886, 43612, 979194, 82998, 81245, 45485, 22647, 57080, 29393, 63841, 77967, 15060, 36101, 40238, 82477, 80572, 57816, 86015, 9520, 44722, 20266, 28652, 50033, 48325, 981986, 93059, 31406, 61328, 13955, 54189, 71588, 3365, 80777, 43676, 18946, 39969, 27548, 78363, 20288, 43511, 45663, 50207, 52173, 64972, 63119, 68533, 43921, 910134, 49891, 43227, 966053, 35636, 960139, 989312, 60744, 35674, 991069, 35382, 78304, 2929, 67501, 61823, 7755, 35051, 965123, 6028, 55951, 52182, 36318, 92902, 935636, 86548, 48356, 69729, 61830, 83348, 57598, 59287, 13918, 5137, 55680, 49965, 83280, 26349, 27335, 93379, 27280, 24723, 72739, 857949, 76097, 67503, 40965, 95980, 16216, 47377, 56728, 798529, 979355, 76142, 66112, 83678, 32941, 6064, 84365, 90728, 18754, 42925, 23466, 53439, 82116, 83595, 61209, 60163, 84243, 86423, 36979, 77579, 71288, 10784, 33435, 3145, 26865, 15400, 60906, 10439, 20641, 43338, 84380, 23704, 17093, 47083, 89724, 27168, 70336, 70834, 11660, 52140, 19500, 81869, 81818, 71722, 14676, 67453, 953951, 15521, 5449, 910580, 62391, 33255, 75245, 84994, 34173, 73216, 39986, 75320, 988836, 27519, 959431, 11331, 78821, 81549, 57268, 47426, 34305, 48389, 958969, 96705, 34747, 41466, 77628, 58465, 70710, 32489, 7165, 75695, 75775, 33362, 16409, 16201, 2574, 32013, 24951, 9612, 5679, 18717, 44886, 74117, 91396, 11258, 68780, 97777, 25597, 84153, 47597, 995163, 22915, 985447, 988074, 14917, 51766, 34442, 61946, 71315, 6273, 90576, 972882, 23254, 64144, 42429, 29624, 42168, 30965, 39464, 46349, 63868, 45384, 18643, 984612, 974013, 79118, 992381, 24296, 3948, 83434, 28826, 68052, 76454, 22830, 52869, 964823, 36850, 82413, 2153, 57028, 35689, 35208, 978266, 35965, 70511, 10867, 25432, 63652, 49506, 20958, 80623, 949436, 54002, 76329, 32298, 68241, 11259, 55691, 71467, 17983, 6382, 40526, 900213, 20542, 14383, 985149, 67553, 58694, 79065, 60387, 43984, 52654, 976235, 64893, 84921, 27093, 25524, 59257, 80896, 77921, 88833, 31894, 37898, 7952, 32122, 57929, 992742, 8046, 85445, 18204, 41511, 988667, 42052, 966466, 971205, 51080, 36369, 37799, 72158, 84109, 53071, 40125, 44920, 94035, 25472, 990056, 84956, 59980, 88335, 13959, 52437, 84673, 32888, 59895, 72613, 37753, 25607, 23738, 82716, 992989, 36002, 27569, 24377, 28955, 81272, 35529, 27360, 47397, 25112, 7072, 63616, 74413, 24344, 979030, 38953, 1086, 995238, 52732, 909969, 73758, 31119, 16267, 987853, 66494, 999764, 985253, 37598, 53732, 55440, 984869, 76489, 18984, 41092, 73544, 47527, 8220, 87842, 15703, 82541, 2754, 81566, 969287, 83487, 57313, 62939, 81309, 3676, 26736, 63625, 19140, 18613, 3670, 31279, 16627, 55870, 26018, 76663, 59864, 74188, 838, 13660, 86815, 76178, 47182, 89115, 3243, 50335, 35442, 57012, 62372, 6079, 20092, 942262, 7588, 77474, 76622, 9445, 13391, 87366, 92864, 19980, 3457, 997663, 37349, 46652, 49590, 930529, 82955, 76745, 58961, 28887, 45287, 32509, 83598, 60103, 56612, 974016, 24424, 64978, 73262, 27022, 70306, 60866, 20972, 55925, 57177, 27527, 72675, 48122, 72133, 15583, 26887, 71205, 996381, 73063, 316, 82326, 97909, 986613, 15684, 16942, 947097, 74637, 999246, 24242, 42335, 72240, 78402, 62985, 59611, 52703, 90148, 22378, 6225, 41850, 939557, 998491, 70068, 15338, 1875, 33333, 30638, 26479, 22909, 56190, 66983, 84293, 59098, 95720, 990721, 1822, 72787, 72493, 996509, 77621, 57566, 41870, 89281, 6055, 69834, 31623, 8182, 6201, 7459, 76323, 978859, 42346, 994782, 75220, 51317, 3561, 943406, 7678, 68361, 38854, 3155, 47258, 7822, 75777, 58106, 97198, 971225, 68666, 74717, 82479, 77298, 90089, 43061, 78314, 35569, 17454, 84059, 36804, 407, 24562, 1627, 63874, 86349, 86596, 59743, 61659, 1513, 67886, 19741, 71237, 955848, 69590, 75398, 952792, 37739, 22501, 71238, 14171, 8522, 43759, 9668, 47388, 64878, 53364, 71739, 33250, 65937, 9887, 8802, 5271, 980700, 31814, 29077, 24250, 964006, 32886, 88952, 17685, 49904, 42337, 46395, 52375, 39701, 36145, 8369, 95373, 45751, 58022, 40800, 79306, 72363, 12948, 52546, 55421, 24279, 67734, 65871, 63674, 96572, 64634, 79636, 999917, 79598, 76859, 66584, 954166, 77209, 89704, 50662, 35978, 41306, 22284, 872126, 949877, 12411, 32017, 84961, 84609, 82708, 76822, 19189, 76786, 10795, 60571, 25994, 9938, 41387, 36332, 59667, 89223, 36322, 7861, 50543, 85911, 73008, 32044, 57036, 8576, 971636, 44747, 62965, 52004, 76772, 89382, 23894, 71574, 5752, 53339, 56637, 76381, 91270, 80224, 18131, 955236, 38441, 940924, 48061, 55216, 66546, 31904, 94904, 63788, 31837, 6216, 18301, 47031, 69797, 53822, 993959, 9277, 27855, 871138, 56969, 988354, 74657, 57511, 27017, 85371, 61379, 68908, 50177, 58172, 75167, 1503, 55018, 90834, 73846, 58509, 44135, 50220, 50160, 7238, 47819, 23498, 64253, 56439, 14984, 96112, 982185, 35067, 65452, 969846, 67569, 33381, 18512, 83694, 24081, 22522, 980782, 70930, 47561, 25603, 50491, 51746, 79819, 66371, 64988, 17686, 90467, 92220, 45054, 13706, 71604, 980368, 34108, 23120, 16381, 17962, 91571, 24795, 67003, 4315, 56054, 15449, 39235, 66796, 70294, 49294, 52274, 88527, 79845, 86751, 8049, 49570, 95697, 19234, 992798, 67915, 65995, 62016, 26494, 958207, 57238, 44669, 12097, 46587, 48230, 64307, 31897, 77488, 76951, 986, 8687, 991826, 62461, 18153, 65447, 996347, 31026, 84774, 55290, 64325, 84256, 15309, 59320, 56904, 70242, 86881, 14262, 92494, 74629, 32492, 75436, 28158, 79980, 15293, 64075, 11522, 859172, 40553, 7999, 17684, 974124, 28289, 11209, 88752, 69555, 967824, 3127, 15298, 85755, 65982, 992975, 65277, 82055, 64373, 80848, 89136, 50783, 68116, 965595, 68262, 938249, 92424, 65539, 15736, 86406, 70873, 57489, 73014, 81191, 39929, 1139, 17673, 4317, 35309, 79361, 49033, 79324, 36063, 31596, 77867, 18921, 11170, 17798, 35458, 21435, 44205, 62411, 19813, 32856, 13021, 29719, 999487, 75801, 18460, 3605, 39726, 66469, 86665, 90127, 65029, 71958, 21084, 57952, 4982, 21350, 993334, 85620, 71015, 75723, 14606, 51531, 60081, 961876, 69424, 35560, 83396, 78331, 46245, 996156, 8025, 53577, 69177, 2298, 62143, 86918, 73723, 995143, 56322, 73760, 998201, 70027, 75973, 15176, 11672, 63463, 85594, 54857, 84503, 92135, 58554, 75744, 57179, 10620, 80213, 83857, 44378, 60523, 10361, 36186, 81962, 81308, 994278, 42830, 960377, 77103, 58826, 39277, 41453, 60047, 53720, 84517, 91959, 75698, 81296, 35824, 70459, 71033, 939227, 15647, 90003, 9402, 24844, 72683, 73481, 982575, 29653, 64457, 60879, 997570, 70416, 81095, 83241, 326, 30352, 29789, 983885, 24215, 9690, 75848, 926731, 991881, 87227, 984243, 45940, 36903, 29031, 73252, 89669, 21817, 73197, 943584, 49816, 4990, 45397, 28536, 50987, 69735, 30270, 27590, 14308, 90707, 37241, 73182, 84706, 494, 77138, 32090, 74970, 50762, 31517, 61991, 14852, 56753, 81270, 77266, 987304, 84545, 12803, 92325, 89020, 45568, 80146, 18327, 92640, 87478, 85364, 2305, 48081, 56150, 90492, 90774, 64776, 3042, 68988, 51989, 74668, 90349, 2146, 36391, 9058, 79987, 70100, 98429, 93897, 15620, 51605, 39051, 986452, 93868, 18307, 58001, 80952, 1687, 60503, 31317, 55957, 70678, 29264, 34144, 59438, 79794, 40408, 80247, 88458, 79033, 52296, 6952, 21563, 997161, 36984, 979688, 61214, 934788, 10351, 13288, 26448, 54202, 977965, 805, 62373, 33415, 57514, 72109, 73626, 55260, 49122, 29818, 5450, 48715, 69290, 76706, 77918, 81124, 91167, 74971, 996742, 34119, 33191, 976174, 6143, 46336, 54097, 71051, 23668, 65260, 91890, 58496, 28725, 86380, 86684, 46694, 978815, 20874, 73967, 86752, 985708, 14637, 998016, 968705, 2005, 33455, 71396, 27225, 28187, 53623, 34321, 86131, 1825, 68520, 995697, 53612, 51817, 9276, 3850, 21374, 9725, 84746, 13554, 58486, 83885, 92913, 938374, 48585, 49, 71579, 24896, 34925, 86228, 16211, 32726, 4853, 80701, 80892, 56123, 79889, 36711, 7348, 31733, 95359, 74425, 83739, 42304, 71819, 20035, 89835, 967299, 19146, 64665, 990217, 16554, 981316, 20513, 64227, 977971, 986461, 7302, 27405, 64186, 961532, 6050, 15734, 82320, 5736, 961363, 909459, 6400, 76046, 83796, 50802, 57937, 32136, 39971, 5091, 84146, 44150, 12078, 23156, 21663, 1976, 36284, 46960, 940586, 96260, 56971, 5496, 63644, 49393, 30281, 996144, 1129, 4726, 78147, 37521, 39977, 14675, 58900, 1135, 45999, 998820, 58885, 44597, 55389, 55772, 83220, 77737, 93529, 12395, 72546, 57529, 87447, 33045, 29678, 48378, 55956, 964921, 913942, 76338, 85483, 52509, 61257, 17881, 18125, 27646, 48838, 25083, 24352, 84019, 60414, 30180, 55293, 12560, 51268, 5971, 14813, 52256, 55677, 73163, 44870, 15520, 935095, 12307, 4655, 1231, 41967, 70608, 89454, 87754, 43614, 947338, 43086, 78777, 81358, 80732, 42445, 84193, 41929, 868770, 45404, 81290, 59915, 55771, 81768, 67214, 58364, 46452, 84909, 6502, 34921, 41771, 78542, 35425, 979513, 69973, 42590, 30660, 59785, 79107, 31104, 7995, 79015, 48799, 2630, 85714, 54489, 81436, 47623, 83933, 63285, 82226, 63960, 30640, 74372, 82950, 86491, 28146, 36925, 901300, 23986, 30695, 23748, 49166, 89262, 49038, 31332, 34067, 49980, 77411, 20028, 70669, 19743, 8472, 80390, 86646, 36372, 33876, 52445, 936367, 52663, 31127, 47030, 90525, 77726, 72192, 3418, 6294, 13714, 77991, 898758, 56758, 16523, 63338, 45024, 42745, 24778, 78119, 75589, 79356, 63017, 69906, 2624, 43752, 999803, 999305, 15208, 91774, 20722, 34636, 16224, 42500, 20485, 34552, 958868, 54556, 41322, 81414, 62440, 50570, 8198, 47355, 60997, 956512, 83936, 35238, 92885, 29734, 631, 76450, 81527, 75183, 82131, 999660, 62814, 61853, 82659, 70324, 14599, 68376, 62857, 983898, 47178, 930059, 21410, 63739, 55419, 50831, 12350, 54543, 41938, 53773, 987230, 50704, 25169, 39290, 44570, 56808, 88536, 33584, 32857, 9188, 10927, 12680, 92749, 72205, 41243, 993075, 42136, 998950, 48027, 80428, 42617, 960086, 93741, 64539, 32316, 72306, 17267, 8376, 983482, 58547, 946002, 71593, 62459, 82947, 19702, 67043, 80439, 50116, 38763, 51927, 37406, 37344, 6603, 1804, 17743, 68096, 14550, 46514, 986287, 12831, 40333, 70802, 17369, 94088, 33588, 10142, 33634, 58949, 61076, 982314, 995189, 63096, 5142, 51673, 64372, 885880, 47220, 1931, 45502, 72516, 26543, 999942, 68166, 36455, 967005, 77556, 40603, 988161, 958109, 979375, 983266, 72400, 45284, 50566, 65061, 50212, 54105, 37428, 29823, 998749, 967434, 47161, 46447, 30412, 91225, 990685, 83576, 961005, 25091, 55248, 37951, 90797, 66685, 83561, 2450, 39554, 41592, 48611, 50768, 61618, 83845, 76214, 69227, 78992, 943298, 48214, 924496, 57897, 17529, 50312, 63991, 28404, 66300, 86501, 87927, 54524, 58821, 915171, 39046, 7007, 3855, 50557, 55130, 43193, 15105, 12327, 56907, 32095, 10045, 14187, 90618, 84822, 994708, 3655, 75202, 45129, 75770, 9935, 987915, 28872, 46454, 71858, 70051, 59681, 31895, 58033, 971884, 59389, 16079, 36009, 71632, 6691, 22794, 82616, 21340, 942033, 70894, 52011, 49969, 26111, 45483, 93601, 923299, 43727, 64299, 65818, 964808, 71637, 13658, 50403, 62758, 60521, 34310, 64851, 82313, 76907, 993914, 45430, 77079, 60426, 37303, 2768, 13775, 68660, 12596, 918, 25249, 52930, 992736, 27062, 43141, 992573, 78491, 9568, 56204, 80865, 17941, 41061, 61672, 56297, 64289, 50705, 93473, 959760, 40215, 44892, 44240, 47039, 87159, 62690, 956034, 81638, 977535, 31058, 54537, 49202, 67084, 70060, 58987, 78326, 27672, 89452, 5592, 84340, 65553, 57720, 63054, 47693, 957910, 88283, 16829, 33184, 42953, 1623, 20653, 75897, 96948, 96702, 81764, 11849, 959356, 10431, 50434, 75399, 31325, 55094, 5692, 966691, 65711, 27386, 34457, 941556, 851, 33280, 16833, 70189, 956465, 55912, 974104, 989414, 44917, 930793, 878982, 6834, 62456, 18433 ]
print(s.solve(A))
129 97 98 93 106 27 61 -1 173 40 78 22 152 99 114 47 69 -1 -1 110 144 14 56 165 174 49 1 57 126 123 100 30 -1 -1 -1 161 13 139 2 85 128 119 177 -1 169 135 77 112 50 17 140 138 58 -1 -1 105 -1 -1 -1 -1 70 -1 -1 102 -1 -1 103 -1 176 -1 -1 115 132 154 125 5 -1 108 36 32 7 -1 -1 148 -1 153 16 130 72 -1 -1 95 116 48 104 -1 -1 20 156 -1 -1 88 -1 142 175 -1 64 133 83 94 -1 4 71 101 -1 -1 -1 -1 42 -1 -1 -1 -1 134 166 28 92 33 82 74 45 -1 -1 168 -1 9 -1 44 26 -1 -1 170 6 -1 -1 89 143 160 -1 68 178 111 167 -1 109 151 -1 -1 -1 81 23 -1 -1 -1 -1 -1 -1 66 11 10 179 15 96 -1 127 18 163 -1 -1 24 29 -1 -1 -1 -1 -1 34 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 21 118 -1 31 -1 35 -1 37 -1 122 162 3 -1 -1 -1 121 59 -1 -1 -1 19 158 157 -1 171 84 46 149 -1 -1 -1 -1 76 147 54 150 -1 -1 -1 -1 63 62 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 86 43 55 -1 -1 -1 -1 172 120 -1 -1 91 155 8 107 -1 -1 -1 164 -1 -1 113 -1 73 137 -1 -1 39 -1 -1 41 -1 -1 -1 75 146 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 90 -1 145 -1 -1 117 51 -1 -1 136 -1 79 80 -1 53 52 -1 -1 -1 159 -1 -1 -1 60 -1 -1 -1 131 -1 38 12 -1 -1 -1 -1 124 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 67 65 -1 87 -1 25 -1 141 -1 -1 -1 -1


[129 ] [98 97 ] [106 93 61 27 ] 
[129 ] [98 97 ] [93 106 27 61 ]